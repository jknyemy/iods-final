library(MASS)
library(dplyr)
library(ggplot2)
library(GGally)
library(corrplot)
library(sfsmisc)
data("Boston")
bosvar1 <- c("crim", "zn", "indus", "nox", "rm", "age", "dis")
boston_m1 <- select(Boston, one_of(bosvar1))
bosvar2 <- c("rad", "tax", "ptratio", "black", "lstat", "medv")
boston_m2 <- select(boston_m, one_of(bosvar2))
boston_m2 <- select(Boston, one_of(bosvar2))
Boxplot(boston_1)
boxplot(boston_1)
boxplot(boston_m1)
boston_m1 <- select(Boston, one_of(bosvar1)) %>% boxplot()
boston_m2 <- select(Boston, one_of(bosvar2)) %>% boxplot()
summary(Boston)
bosvar1 <- c("crim", "zn", "indus", "nox", "rm", "dis")
boston_m1 <- select(Boston, one_of(bosvar1)) %>% boxplot()
bosvar1 <- c("indus", "nox", "rm", "dis")
boston_m1 <- select(Boston, one_of(bosvar1)) %>% boxplot()
bosvar1 <- c("indus", "lstat", "medv", "ptratio", "rad","crim", "dis")
boston_m1 <- select(Boston, one_of(bosvar1)) %>% boxplot()
bosvar2 <- c("black", "tax", "age", "rm", "zn")
boston_m2 <- select(Boston, one_of(bosvar2)) %>% boxplot()
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
boston_m1 <- select(boston_scaled, one_of(bosvar1)) %>% boxplot()
bosvar2 <- c("black", "tax", "age", "rm", "zn")
boston_m2 <- select(boston_scaled, one_of(bosvar2)) %>% boxplot()
bosvar2 <- c("black", "tax", "age", "rm", "zn", "nox")
boston_m2 <- select(boston_scaled, one_of(bosvar2)) %>% boxplot()
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm", "ptratio","zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1)) %>% boxplot()
boston_m2 <- select(boston_scaled, one_of(bosvar2)) %>% boxplot()
knitr::opts_chunk$set(echo = TRUE)
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm","ptratio", "zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1)) %>% boxplot()
boston_m2 <- select(boston_scaled, one_of(bosvar2)) %>% boxpl
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm","ptratio", "zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1)) %>% boxplot()
boston_m2 <- select(boston_scaled, one_of(bosvar2)) %>% boxplot()
cor_matrix<-cor(Boston) %>% round(digits = 2)
corrplot(cor_matrix, method="circle", type = "upper", cl.pos = "b", tl.pos = "d", tl.cex = 0.6)
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm","ptratio", "zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1))
boxplot(boston_m1)
boston_m2 <- select(boston_scaled, one_of(bosvar2))
boxplot(boston_m2)
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm","ptratio", "zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1))
boxplot(boston_m1)
boston_m2 <- select(boston_scaled, one_of(bosvar2))
boxplot(boston_m2)
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
bosvar1 <- c("indus", "lstat", "medv", "rad","crim", "dis")
bosvar2 <- c("black", "tax", "age", "rm","ptratio", "zn", "nox")
boston_m1 <- select(boston_scaled, one_of(bosvar1))
boxplot(boston_m1)
boston_m2 <- select(boston_scaled, one_of(bosvar2))
boxplot(boston_m2)
source('~/GitHub/iods-final/data/create_human_aid.R', echo=TRUE)
str(hdi.aid)
hdi.aid <- bind_cols(hdi1, hdi.aid)
str(hdi.aid)
#Sorting alphabetically by country name so it is easier to combine
#with other data.
hdi.aid2 <- hdi.aid[order(hdi.aid$Country),]
#Loading the Gapminder women's fertility data, selecting the year 20
#2014 and deleting missing values.
fert <- read.xlsx2("indicator undata total_fertility_1.xlsx", sheetIndex=1)
str(fert)
keep_columns <- c("Country", "X2014")
fert2014 <- select(fert, one_of(keep_columns))
fert2014$X2014 <- as.numeric(levels(fert2014$X2014))[fert2014$X2014]
fert2014$Country <- as.character(fert2014$Country)
fert2014$miss <- complete.cases(fert2014)
fert2014_1 <- filter(fert2014, miss==TRUE)
fert2014_1 <- select(fert2014_1, -miss)
names(hdi.aid3)[names(hdi.aid3) == "X2014"] <- "Fert"
#Combining the data
hdi.aid3 <- inner_join(hdi.aid2, fert2014_1, by = "Country")
View(hdi.aid3)
#Loading Gapminder's data on foreign aid received provided by World Bank
#The point of this data is to get an indication of aid received which
#which would have had time to affect the country in question.
#To this end I will calculate a mean of aid received a 20 year
#period to year 2004, which is 10 years before
#the other data. Also a column that tells the amount of years that mean is
#calculated from, to give an indication of how consistent the aid
#has been.
aid <- read.xlsx2("indicator_aid received % of gni_1.xlsx", sheetIndex=1)
aid2 <- select(aid, X1984:X2004)
indx <- sapply(aid2, is.factor)
aid2[indx] <- lapply(aid2[indx], function(x) as.numeric(as.character(x)))
str(aid2)
aid$mean04 <- rowMeans(aid2, na.rm=TRUE)
mean.length <- apply(aid2, MARGIN = 1, FUN = function(x) length(x[!is.na(x)]) )
aid$mean.length <- mean.length
keep_columns2 <- c("Country", "mean04", "mean.length")
aid3 <- select(aid, one_of(keep_columns2))
View(aid3)
#Combining data.
hdi.aid4 <- inner_join(hdi.aid3, aid3, by = "Country")
View(hdi.aid4)
#Loading under 5 child mortality/1000 live births for the year
#2014 from Gapminder and combining it o the dataset.
mort <- read.xlsx2("indicator gapminder under5mortality_1.xlsx", sheetIndex = 1)
keep_columns3 <- c("Country", "X2014")
child.mort <- select(mort, one_of(keep_columns3))
names(child.mort)[names(child.mort) == "X2014"] <- "child.mort"
View(child.mort)
child.mort$Country <- as.character(child.mort$Country)
child.mort$child.mort <- as.numeric(child.mort$child.mort)
str(child.mort)
#Combining data
hdi.aid5 <- inner_join(hdi.aid4, child.mort, by = "Country")
View(hdi.aid5)
str(hdi.aid5)
write.csv2(hdi.aid5, "hdi_aid.csv")
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
library(ggplot2)
library(MASS)
library(corrplot)
library(GGally)
library(FactoMineR)
library(dplyr)
hdi.aid <- read.csv2("hdi_aid.csv")
rownames(hdi.aid) <- hdi.aid$Country
str(hdi.aid)
hdi.aid <- dplyr::select(hdi.aid, -Country)
str(hdi.aid)
hdi.aid <- read.csv2("hdi_aid.csv")
hdi.aid <- read.csv2("hdi_aid.csv")
row.names(hdi.aid) <- hdi.aid$Country
hdi.aid <- read.csv2("hdi_aid.csv")
row.names(hdi.aid) <- hdi.aid$Country
str(hdi.aid)
hdi.aid <- read.csv2("hdi_aid.csv", stringsAsFactors = FALSE)
row.names(hdi.aid) <- hdi.aid$Country
str(hdi.aid)
ro_nam <- hdi.aid$Country
ro_nam
class(ro_nam)
row.names(hdi.aid) <- ro_nam
str(hdi.aid)
hdi.aid <- read.csv2("hdi_aid.csv", stringsAsFactors = FALSE)
hdi.aid <- dplyr::select(hdi.aid, -Country)
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
pca_hdi <- prcomp(hdi.aid2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"))
pca_human
pca_human
names <- hdi.aid$Country
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
pca_hdi <- prcomp(hdi.aid2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
names <- hdi.aid$Country
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
names <- hdi.aid2$Country
pca_hdi <- prcomp(hdi.aid2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
names
hdi.aid <- read.csv2("hdi_aid.csv", stringsAsFactors = FALSE)
row.names(hdi.aid) <- ro_nam
hdi.aid <- read.csv2("hdi_aid.csv", stringsAsFactors = FALSE)
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
names <- hdi.aid2$Country
names
pca_hdi <- prcomp(hdi.aid2)
hdi.aid2 <- dplyr::select(hdi.aid2, -Country)
pca_hdi <- prcomp(hdi.aid2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
pca_hdi
hdiaid2_sc <- scale(hdi.aid2)
pca_hdi <- prcomp(hdi.aid2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
pca_hdi
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names, ylim= 0.2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names, ylab= 0.2)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names, ylim = 52000)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
pca_hdi <- prcomp(hdi.aid2_sc)
pca_hdi <- prcomp(hdiaid2_sc)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
names <- hdi.aid2$Country
hdi.aid2 <- dplyr::select(hdi.aid2, -Country)
hdiaid2_sc <- scale(hdi.aid2)
pca_hdi <- prcomp(hdiaid2_sc)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
pca_hdi
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
names <- hdi.aid2$Country
hdi.aid2 <- dplyr::select(hdi.aid2, -Country)
hdiaid2_sc <- scale(hdi.aid2)
pca_hdi <- prcomp(hdiaid2_sc)
biplot(pca_hdi, choices = 1:2, cex = c(0.8, .8), col = c("red", "blue"), xlabs = names)
pca_hdi
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
names <- hdi.aid2$Country
hdi.aid2 <- dplyr::select(hdi.aid2, -Country)
hdiaid2_sc <- scale(hdi.aid2)
pca_hdi <- prcomp(hdiaid2_sc)
biplot(pca_hdi, choices = 1:2, cex = c(2, 2), col = c("red", "blue"), xlabs = names)
pca_hdi
comp <- complete.cases(hdi.aid)
hdi.aid2 <- hdi.aid
hdi.aid2$comp <- comp
hdi.aid2 <- filter(hdi.aid, comp==TRUE)
hdi.aid2 <- dplyr::select(hdi.aid2, -comp)
names <- hdi.aid2$Country
hdi.aid2 <- dplyr::select(hdi.aid2, -Country)
hdiaid2_sc <- scale(hdi.aid2)
pca_hdi <- prcomp(hdiaid2_sc)
biplot(pca_hdi, choices = 1:2, cex = c(2.5, 2.5), col = c("red", "blue"), xlabs = names)
pca_hdi
str(hdi.aid)
source('~/GitHub/iods-final/data/create_human_aid.R', echo=TRUE)
